# PUBG Mobile Servers Tracing

Интернет заходит через роутер mikrotik  (его беру как пример)   
так как важно чтобы была возможность смотреть соединения которые проходят через него подойдет более-мение продвинутый роутер.   
У меня команда выглядит так    
`ip/firewall/connection/print where src-address ~"192.168.200.105" and protocol=udp`    
где `192.168.200.105` айпи моего айпада в локальной сети.  
Так же нам интересен только `udp` протокол, так как игра использует его для передачи собыйтий. 

```
[d@MikroTik-I] > ip/firewall/connection/print where src-address ~"192.168.200.105" and protocol=udp
Flags: S - SEEN-REPLY; A - ASSURED; C - CONFIRMED; F - FASTTRACK; s - SRCNAT
Columns: PROTOCOL, SRC-ADDRESS, SRC-PORT, DST-ADDRESS, DST-PORT, TIMEOUT, ORIG-RATE, REPL-RATE, ORIG-PACKETS, REPL-PACKETS, ORIG-BYTES, REPL-BYTES
#       PROTOCOL  SRC-ADDRESS      SRC-PORT  DST-ADDRESS     DST-PORT  TIMEOUT  ORIG-RATE  REPL-RATE  ORIG-PACKETS  REPL-PACKETS  ORIG-BYTES  REPL-BYTES
0 S C   udp       192.168.200.105     50551  192.168.200.1         53  1s       0bps       0bps                  1             1          70         116
1   CFs udp       192.168.200.105     65480  49.51.134.54       17000  59s      264bps     0bps                 39             0       1 287           0
2 SACFs udp       192.168.200.105     63674  172.224.106.11       443  47s      0bps       0bps                  1             9       1 378       6 112
3 S C   udp       192.168.200.105     58105  192.168.200.1         53  1s       0bps       0bps                  1             1          78          78
4 S C   udp       192.168.200.105     65301  192.168.200.1         53  1s       0bps       0bps                  1             1          69          69
5   C s udp       192.168.200.105     53293  172.217.17.234       443  33s      0bps       0bps                  1             0          58           0
6 SACFs udp       192.168.200.105     51646  20.199.56.36       14382  4m59s    31.1kbps   23.2kbps          5 359         3 214     333 059     349 891
7 SACFs udp       192.168.200.105     58395  101.33.48.209        443  4m45s    0bps       0bps                 18            21       5 371       7 831
8 S C   udp       192.168.200.105     60550  192.168.200.1         53  1s       0bps       0bps                  1             1          70         218
```

нас интересуют соединения на порты `10010,10013,10039,10096,10491,10612,11455,12235,13748,13894,13972,20000-20002`  
ищем адреса хоcтов с подключением к этим портам. Обычно это `20000-20002` порт, остальные не интересуют.
у меня это  

```
49.51.134.54
20.199.56.36
```
идем на https://www.maxmind.com/en/geoip-demo вставляем адреса
ищем ближайший сервер Tencent, скорее всего вы играете в дайнный момент именно на нем, для СНГ (Европы) это обычно Франкфурт, Стамбул или что-то в Финляндии, если вы играете на Европе:

![geoip-demo screenshot](/Screenshot1.png)

`49.51.134.54` это как раз и есть сервер на котором мы игрем, `20.199.56.36` это какой-то сервис эйжур, нам не интересен.

Делаем пинг на него `ping 49.51.134.54` , и результат близок к тому что показывает игра:

![ping screenshot](/Screenshot3.png)

Далее можно сделать `sudo mtr 49.51.134.54` чтобы посмотреть маршрут и задержки по пути:

![mtr screenshot](/Screenshot2.png)

Где видем не все пакеты проходят, что в игре выглятит как отсутсвие регистрации, лаги, телепортация персонажей.


